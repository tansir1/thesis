%\chapter{Task Allocation}


%\section{Task allocation using only one way communication}
%\section{Territorial task allocation}
\section{Territorial task allocation}
\label{sec:uncoordTaskingMyWork}
The allocation scheme used in this work is more closely aligned to the fully decentralized end of the spectrum.  It models the behaviors of territorial animals that shout, posture, or otherwise mark their domains so that other members of their species do not encroach.  The benefit of this behavior is that only one way communication is required.  There's no need for sequential data handling protocols.  If other agents exist within communications range they will share their belief models but they will not otherwise directly engage each other.  

Periodically agents analyze their belief model to find the best action they can do.  There are only two strongly enforced rules to control who performs a particular task.  

\begin{enumerate}
	\item The agent with the best Monitor or Attack score in the Target Belief data structure gets to perform the task.
	\item Once an Attack task's state is set to \textit{Performing} no other agent may claim the task regardless of rule 1.
\end{enumerate}

Rule 1 states that a ``survival of the fittest'' situation occurs.  If multiple UAVs compete for the same task then the strongest agent wins the task.  Scores are computed based on the UAV's ability to perform the task and their current distance from the task.  While it is theoretically possible for ties in scoring to occur in practice it is inconsequential.  The ability to perform a task has many variables and distances to the targets are always changing.  Each UAV's score will change slightly at the next periodic update.

When a task's state changes to \textit{NO TASK}, \textit{Open}, or \textit{Enroute} any UAV may attempt to claim it.  Claiming occurs when an agent is close enough to begin performing the action and they set the Task State to \textit{Performing}.  An agent may choose to stop performing a task by resetting the task's state to \textit{Open}.  When an agent claims an attack task rule 2 comes into affect and no other UAV may take the task.  UAVs performing the Monitor task may be overridden if another UAV comes within range with a significantly better score.  The definition of significantly better is definable by the operator as a percentage.   This helps to prevent churn in the monitoring process but allows a much better sensor to be utilized if it presents itself.  Either way, someone is always watching the target.
%\textbf{TODO: write out algorithm for task claiming}

These rules only work in an environment where no agent lies.  An agent can have out of date information and faulty sensors but they cannot actively lie.  All information is timestamped using a synchronized clock so stale data is a recoverable error and accounted for in all comparison and merging processes.  Faulty sensors can be overcome by other members of the swarm repeatedly contradicting the bad data.

Tasks start in the \textit{NO TASK} state when they are first discovered.  The discovering agent will add the task to their belief model and broadcast it out locally.  Other agents may hear about the new task and rebroadcast it out again when they next transmit their belief model.  In this fashion the task will propagate through the network.  However, there is a latency in the logic processing between agents near the task and those farther away.  It takes time for the task to hop from the interior to the exterior of the swarm.  During this timespan agents closer to the task may already begin to posture to claim it while those farther away are just first hearing about it.  There is a weighting factor set by the operator to specify if they prefer the closest UAV to perform the task or if they prefer the best equipped UAV to perform the task.  This weighting factor allows UAVs far away from the initial task announcement a chance to claim the task.

When a UAV thinks it can claim a task it sets the Target Belief data with the computed score, the UAV's ID, and sets the Task State to Enroute.  Other UAVs will hear these updates at the next periodic belief model broadcast.  Simultaneously other UAVs could believe they will claim the task as well and eventually multiple UAVs could arrive near the task.  While they are all enroute their beliefs propagate through the network and merge with others.  Eventually some of the UAVs will hear that they are not the best suited for the task and will go find some other task to perform.  This competition period emulates the centralized controller strength in that someone coordinates who gets to perform the task.  In this case the centralized controller changes swiftly based on who the dominant UAV is at the time.  The dominant UAV effectively guards their territory like an animal until a stronger one appears.

This simple ``survival of the fittest'' mechanism has many benefits.  Very little communication is required and no bidirectional communication occurs at all.  UAVs share their belief model of the world which is just a static data dump with well defined merging procedures.  Other UAVs hear this whole data packet or they hear nothing at all.  There is no need to maintain and manage temporary communication channels to facilitate negotiations or transactions like in market based algorithms.  This mechanism is most closely related to pheromone models with each UAV having their own unique pheromone signature.  This means the control laws for global navigation of the aircraft consolidate down to a series of strength comparisons with no higher level logic.  The formal algorithm for this task allocation scheme is written in~\ref{alg:taskAlloc}.
%\textbf{TODO: This is the whole point of thesis}
